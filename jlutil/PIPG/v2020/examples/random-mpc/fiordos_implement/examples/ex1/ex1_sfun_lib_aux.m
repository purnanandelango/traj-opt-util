function ex1_sfun_lib_aux(id,varargin)
% auxiliary file for ex1_sfun_lib

% 
% This file is generated by FiOrdOs, a program licensed under GPL
% by copyright holder Automatic Control Laboratory, ETH Zurich.
% 
% If you are interested in using this file commercially,
% please contact the copyright holder.
% 

switch id
    case 'cb'
        maskCallback(varargin{:});
    case 'init'
        maskInit(varargin{:});
    otherwise
        error('Unknown identifier "%s".',id);
end
end

function maskCallback(blk,maskParamNum)
vals = get_param(blk,'MaskValues');
vis  = get_param(blk,'MaskVisibilities');
switch vals{maskParamNum}
    case {'external'}
        vis{maskParamNum+1}='off';
    case {'internal'}
        vis{maskParamNum+1}='on';
end
set_param(blk,'MaskVisibilities',vis);
end

function maskInit(blk)
try
    bn={'algo.init [10x1]','algo.maxit [1x1]','algo.stopgEps [1x1]'};
    ds={'d_algo_init','d_algo_maxit','d_algo_stopgEps'};
    vals={'s_algo_init','s_algo_maxit','s_algo_stopgEps'};
    portNext=3;
    for i=1:length(ds)
        fullbnm=[blk,'/',bn{i}];
        switch get_param(blk,ds{i})
            case 'external'
                if strcmp(get_param(fullbnm,'BlockType'),'Constant')
                    pos=get_param(fullbnm,'Position');
                    delete_block(fullbnm);
                    try
                        add_block('built-in/Inport',fullbnm);
                    catch err
                    end
                    set_param(fullbnm,'Position',pos,'ForegroundColor','gray');
                end
                set_param(fullbnm,'Port',num2str(portNext));
                portNext=portNext+1;
            case 'internal'
                if strcmp(get_param(fullbnm,'BlockType'),'Inport')
                    pos=get_param(fullbnm,'Position');
                    delete_block(fullbnm);
                    try
                        add_block('built-in/Constant',fullbnm);
                    catch err
                    end
                    set_param(fullbnm,'Position',pos,'Value',vals{i});
                end
        end
    end
catch err
    disp('Failure in Mask Initialization');
    disp(err.identifier);
    disp(err.message);
end
end
