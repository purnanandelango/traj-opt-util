\documentclass[12pt,letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{mathpazo}
\usepackage{microtype}
\usepackage[margin=0.7in]{geometry}
\usepackage{amsmath,amssymb,bm}
\usepackage{url}
\usepackage{hyperref}

\title{High-fidelity Spacecraft Dynamics in Cislunar Space}
\author{Purnanand Elango}
\date{February 4, 2023}

\hypersetup{
    colorlinks=true,
    linkcolor=purple!20!blue,
    filecolor=blue!20!purple,      
    urlcolor=purple!20!blue!60!white,
    pdftitle={Spacecraft EOM},
    pdfauthor={Purnanand Elango},
    citecolor=red!40!white!70!black,
}

\setlength{\parskip}{1ex}
\setlength{\parindent}{0pt}

% TikZ
\usepackage{physics}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{mathdots}
\usepackage{yhmath}
\usepackage{cancel}
\usepackage{color}
\usepackage{siunitx}
\usepackage{array}
\usepackage{multirow}
\usepackage{amssymb}
\usepackage{textcomp,gensymb}
\usepackage{tabularx}
\usepackage{extarrows}
\usepackage{booktabs}
\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}

% Definitions
\renewcommand{\dot}[1]{\overset{\text{{\large .}}}{#1}}
\newcommand{\rsc}{r_{\scriptscriptstyle\text{sc}}}
\newcommand{\lamsc}{\lambda_{\scriptscriptstyle\text{sc}}}
\newcommand{\vsc}{v_{\scriptscriptstyle\text{sc}}}
\newcommand{\brsc}{\bar{r}_{\scriptscriptstyle\text{sc}}}
\newcommand{\drsc}{\dot{r}_{\scriptscriptstyle\text{sc}}}
\newcommand{\dvsc}{\dot{v}_{\scriptscriptstyle\text{sc}}}
\newcommand{\rE}{r_{\scriptscriptstyle\text{E}}}
\newcommand{\rS}{r_{\scriptscriptstyle \text{S}}}
\newcommand{\vE}{v_{\scriptscriptstyle \text{E}}}
\newcommand{\bvE}{\bar{v}_{\scriptscriptstyle \text{E}}}
\newcommand{\ME}{M_{\scriptscriptstyle \text{E}}}
\newcommand{\MM}{M_{\scriptscriptstyle \text{M}}}
\newcommand{\MS}{M_{\scriptscriptstyle \text{S}}}
\newcommand{\RM}{R_{\scriptscriptstyle \text{M}}}
\newcommand{\MJtwo}{M_{\scriptscriptstyle \text{J2}}}
\newcommand{\thteq}{\theta_{\text{eq}}}
\newcommand{\ksc}{k_{\scriptscriptstyle\text{sc}}}
\newcommand{\Msc}{M_{\scriptscriptstyle\text{sc}}}
\newcommand{\Asc}{A_{\scriptscriptstyle\text{sc}}}

\begin{document}

\maketitle

The spacecraft equations of motion are represented in the Earth-centered inertial frame (ECI) defined by Earth's Mean Equator and Mean Equinox (MEME) at 12:00 Terrestrial Time on 1 January 2000, with the origin at the instantaneous Moon center. This frame is labelled as \texttt{J2000} in SPICE.

\begin{subequations}
\begin{align}
    \drsc ={} &\vsc\\
    \dvsc ={} & \displaystyle-G\MM \frac{\rsc}{\|\rsc\|_2^3} + G\ME\left( \frac{\rE - \rsc}{\| \rE - \rsc \|_2^3} - \frac{\rE}{\|\rE\|_2^3}\right) + G\MS\left( \frac{\rS - \rsc}{\| \rS - \rsc \|_2^3} - \frac{\rS}{\|\rS\|_2^3}\right) \nonumber \\
     & - \frac{\ksc\Asc S_0r_0^2}{\Msc c} \left( \frac{\rS - \rsc}{\| \rS - \rsc \|_2^3} \right)\\
     & + \frac{3}{2}G\MM\MJtwo\RM^2\frac{\rsc}{\|\rsc\|_2^5}\left( 3\sin^2 \left( \arccos\left(\frac{\rE^\top \brsc}{\|\rE\|_2\|\brsc\|_2}\right)+\thteq\right) - 1 \right),\nonumber
\end{align}    
\end{subequations}

where 
\begin{align}
    \brsc ={} & \rsc - \displaystyle \frac{\rsc^\top\bvE}{\|\bvE\|^2_2}\bvE,\\
    \bvE ={} & - \rE \times (\rE\times\vE)  = -\rE^\top(\vE\times\rE).  
\end{align}

Note that $\rE,\bvE$ and $\rE\times\vE$ form a right-handed set of orthogonal vectors. The projection of spacecraft position vector onto the plane formed by $\rE$ and $\rE\times\vE$ is denoted by $\brsc$. The angle between $\brsc$ and $\rE$, denoted by $\lamsc$, quantifies the Moon latitude closest to the spacecraft. 

\input{EM-system.tex}

\begin{table}[!htpb]
\centering
\begin{tabular}{l|l}
\hline
 $\rsc$ & Position of spacecraft with respect to Moon\\   
 $\vsc$ & Velocity of spacecraft with respect to Moon\\
 $\rE$  & Position of Earth with respect to Moon\\
 $\vE$  & Velocity of Earth with respect to Moon\\
 $\rS$  & Position of Sun with respect to Moon\\
 $\ksc$ & Reflectivity of spacecraft body\\ 
 $r_0$  & 1 AU\\
 $\Asc$ & Cross-sectional area of spacecraft\\   
 $S_0$  & Solar flux at distance $r_0$ from Sun\\
 $c$    & Speed of light in vacuum\\
 $G$    & Universal gravitational constant\\
 $\Msc$ & Mass of spacecraft\\
 $\ME$  & Mass of Earth\\
 $\MM$  & Mass of Moon\\
 $\MS$  & Mass of Sun\\
 $\MJtwo$ & J2 zonal harmonic coefficient for Moon, $2.024\times 10^{-4}$\\
 $\RM$    & Radius of Moon, 1737.1 km\\
 $\thteq$ & Equitorial inclination of Moon, 6.68$^\circ$\\
\hline
\end{tabular}
\end{table}

The cannonball model of solar radiation pressure assumed here represents the spacecraft as a sphere. As a result, the cross-sectional area $\Asc$ experiencing solar radiation is independent of spacecraft orientation.

% \begin{align}
%     a_{\text{J}_2} ={} & \sin^2 \left( \arccos\left(\frac{\rsc^\top\rE - \displaystyle \frac{\rsc^\top\vE}{\|\vE\|^2_2}\vE^\top\rE}{\|\rE\|_2\left\| \rsc - \displaystyle \frac{\rsc^\top\vE}{\|\vE\|^2_2}\vE \right\|_2}\right)+\thteq\right)    
% \end{align}

\subsection*{Accessing Ephemeris via SPICE}

\href{https://naif.jpl.nasa.gov/naif/toolkit.html}{NAIF SPICE} toolkit for MATLAB, called \texttt{mice}, is necessary for querying ephemeris state of celestial bodies in specific coordinate frames. Download \texttt{mice} from \href{https://naif.jpl.nasa.gov/naif/toolkit_MATLAB.html}{here} and include \path{mice\lib} and \path{mice\src\mice} to MATLAB path.

\subsubsection*{Data}

\begin{itemize}
    \item \texttt{pck00010.tpc} -- Orientation and size/shape data for natural bodies.
    \item \texttt{naif0011.tls.pc} -- Leap second kernel.
    \item  \texttt{de421.bsp} -- Position of planets and Moon between 1900 and 2050. See \href{https://ipnpr.jpl.nasa.gov/progress_report/42-178/178C.pdf}{this document} for more details.
\end{itemize}

\end{document}